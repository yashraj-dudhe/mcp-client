class TimedAbortController extends AbortController {
  /**
   * A `Promise` that will resolve when the `TimedAbortController` is
   * aborted.
   */
  promise;
  timeout;
  resolve;
  constructor(time) {
    super();
    this.promise = new Promise((resolve) => {
      this.resolve = resolve;
      this.timeout = setTimeout(() => {
        if (this.signal.aborted) return;
        this.abort();
      }, time);
    });
    this.signal.addEventListener(
      "abort",
      () => {
        this.resolve();
        if (this.timeout) clearTimeout(this.timeout);
      },
      { once: true }
    );
  }
}

export { TimedAbortController };
