class NestedAbortController extends AbortController {
  constructor(...parents) {
    super();
    const abortedSignal = parents.find((signal) => signal.aborted);
    if (abortedSignal) {
      this.abort(abortedSignal.reason);
    } else {
      const abort = (event) => this.abort(event.target.reason);
      const options = { signal: this.signal };
      for (const signal of parents) {
        signal.addEventListener("abort", abort, options);
      }
    }
  }
}

export { NestedAbortController };
